#!/bin/bash

set -e

fusion_modes=6
# The 3x3 kernels are all executed by OpenCL kernels, the 1x1 kernels use the ASM kernels
for i in $(seq 0 $fusion_modes); do 
    echo "============================================================================================="
    ./build/bin/MIOpenDriver CBAInfer -n 2 -c 2 -H 16 -W 16 -k 2 -x 3 -y 3 -i 1 -p 0 -q 0 -u 1 -v 1 -F $i
    echo "============================================================================================="
done

echo "============================================================================================="
echo "============================================================================================="

echo "Run the assembly kernels"
for i in $(seq 0 $fusion_modes); do 
    echo "============================================================================================="
    ./build/bin/MIOpenDriver CBAInfer -n 2 -c 2 -H 16 -W 16 -k 2 -x 1 -y 1 -i 1 -p 0 -q 0 -u 1 -v 1 -F $i
    echo "============================================================================================="
done
echo "============================================================================================="
echo "============================================================================================="
echo "All cases completed"

